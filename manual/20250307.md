## useEffect() ì •ë¦¬ í•¨ìˆ˜ë¥¼ í™œìš©í•œ ê²½ìŸ ì¡°ê±´ ì²˜ë¦¬

```tsx
import {useEffect, useState } from 'react';

function CarData(props) {
  const [data, setData] = useState({});

  useEffect(() => {
    let ignore = false;
    fetch(`https://carapi.com/car/${props.carid}`)
    .then(response => response.json())
    .then(cardata => {
      if(!ignore) {
        setData(cardata)
      }
    });
  
    return () => {
      ignore = true;
    }
  },[props.carid]);

  if(data) {
    return <div>{data.car.brand}</div>
  }else {
    return null;
  }
}
... ì´í•˜ ìƒëµ ë° ì¶”í›„ ì‘ì„±
```

- useEffect() ë‚´ë¶€ì— ì´ˆê¸°ê°’ì¸ falseì¸ ignore ë³€ìˆ˜(bool)ë¥¼ ì„ ì–¸
- ê·¸ ë‹¤ìŒ ì •ë¦¬ í•¨ìˆ˜ì—ì„œ ignore ë³€ìˆ˜ì˜ ê°’ì„ true ë°”ê¿ˆ
- ìƒíƒœ ì—…ë°ì´íŠ¸ ìƒì—ì„œ ignore ë³€ìˆ˜ì˜ ê°’ì„ í™•ì¸í•˜ê³ , ê°’ì´ falseì¸ ê²½ìš°ì—ë§Œ ìƒíƒœê°€ ì—…ë°ì´íŠ¸ ë˜ëŠ”ë°,ì´ëŠ” ìƒˆë¡œìš´ ê°’ì´ props.caridë¥¼ êµì²´í•˜ì§€ ì•Šì•˜ê³ , íš¨ê³¼ê°€ ì •ë¦¬ë˜ì§€ ì•Šì•˜ìŒì„ ì˜ë¯¸í•¨.

- ì¦‰, í˜„ì¬ ì½”ë“œë¥¼ ì‘ì„±í–ˆì„ ê²½ìš° ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ ë  ë•Œë§ˆë‹¤ ì •ë¦¬í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ê³  ignoreê°€ trueë¡œ ì—…ë°ì´íŠ¸ ë˜ì–´ì„œ íš¨ê³¼ê°€ ì •ë¦¬ë¨. ì¦‰ ë§ˆì§€ë§‰ ìš”ì²­ì˜ ê²°ê³¼ë§Œ ë Œë”ë§ ë˜ë¯€ë¡œ ê²½ìŸ ì¡°ê±´ì„ í”¼í•  ìˆ˜ ìˆìŒ.

ê²½ìŸ ì¡°ê±´ ê³ ë ¤ ì•ˆí•œ ë²„ì „ì˜ ì½”ë“œ ë‚´ìš©
```tsx
import {useState , useEffect} from 'react';

function CarData(props) {
  const [data, setData] = useState({});

  useEffect(() => {
    fetch(`https://carid.com/car/${props.carid}`)
    .then(response => response.json())
    .then(cardata => setData(cardata))
  } , [props.carid]);

  if(data) {
    return <div>{data.car.brand}</div>;
  }else {
    return null;
  }
   ... ì´í•˜ ìƒëµ ë‚˜ì¤‘ì— ë§Œë“¦
}
```

ê²½ìŸ ì¡°ê±´ì„ í”¼í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ë™ì‹œì„± ì œì–´ì™€ ì—¬ëŸ¬ ë©”ì»¤ë‹ˆì¦˜ì„ ì œê³µí•˜ëŠ” ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ë¥¼ ì´ìš©í•¨. ì´ìƒì„ í†µí•´ ì£¼ì–´ì§„ ì¿¼ë¦¬ í‚¤ì— ëŒ€í•´ í•œë²ˆì— í•˜ë‚˜ì˜ ìš”ì²­ë§Œ ì „ì†¡í•˜ë„ë¡ ê´€ë¦¬í•  ìˆ˜ ìˆë„ë¡ í•¨.

## React Query ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´ìš©

ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±
- npm create vite@4.3
- gitapi
- React
- JavaScript
- í´ë” ë„˜ì–´ê°€ì„œ npm install
- github upload
  - git add .
  - git commit -m "feat:react query lesson"
  - git push
- gitapiì—ì„œ npm run dev
- npm install axios
- npm install @tanstack/react-query@4
- App.jsx ì´ˆê¸° ì„¤ì •

### React Queryì˜ ê°œìš”

#### React Queryë€?

: React ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì„œë²„ ìƒíƒœ ê´€ë¦¬ë¥´ ì‰½ê²Œ í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬

1. ê¸°ì¡´ ë°©ì‹(useState / useEffect) vs. React Query
ê¸°ì¡´ ë°©ì‹ ì˜ˆì‹œ
- useState / useEffectë¥¼ ì´ìš©í•´ API ìš”ì²­ ê´€ë¦¬(0306 ìˆ˜ì—…)
- ë§¤ë²ˆ API ìš”ì²­ ì‹œ ë¡œë”© ìƒíƒœë¥¼ ìˆ˜ë™ìœ¼ë¡œ ê´€ë¦¬
- ìºì‹±ì„ ì§ì ‘ êµ¬í˜„í•´ì•¼ í•¨
- Refetchë¥¼ ì§ì ‘ ì½”ë“œë¡œ êµ¬í˜„í•´ì•¼ í•¨

2. React Query
- useQuery í•˜ë‚˜ë¡œ ë°ì´í„° ìš”ì²­ ê°€ëŠ¥
- isLoading, isFetch ë“±ì˜ ìƒíƒœë¥¼ ìë™ìœ¼ë¡œ ì œê³µ
- ìë™ ìºì‹± ë° ë°±ê·¸ë¼ìš´ë“œ ì—…ë°ì´íŠ¸
- staleTime, refetchOnWindowFocus ë“± ì˜µì…˜ ì œê³µ

ê¸°ëŠ¥ìƒ íŠ¹ì§•
- ìë™ ìºì‹± ë° ë°±ê·¸ë¼ìš´ë“œ ì—…ë°ì´íŠ¸ : ë°ì´í„°ê°€ ì˜¤ë˜ë˜ì—ˆëŠ”ì§€ ìë™ìœ¼ë¡œ íŒë‹¨, ë°±ê·¸ë¼ìš´ë“œì—ì„œ ìë™ ì—…ë°ì´íŠ¸ë¥¼ ì‹¤í–‰

ex) staleTimeì„ ì„¤ì •í•˜ì—¬ ì¼ì • ì‹œê°„ ë™ì•ˆ ë°ì´í„° ìš”ì²­ì„ ë°©ì§€í•˜ì—¬ ì„±ëŠ¥ ìµœì í™”

- íŠ¹ì • ì´ë²¤íŠ¸ì—ì„œ ë°ì´í„° ìƒˆë¡œê³ ì¹¨(refetch) : ë²„íŠ¼ í´ë¦­ ì‹œ ë°ì´í„°ë¥¼ ìƒˆë¡œ ë¶ˆëŸ¬ì˜¤ë ¤ë©´ refetch í•¨ìˆ˜ ì‚¬ìš© ê°€ëŠ¥ -> refetch() í˜¸ì¶œ ì‹œ ê¸°ì¡´ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì§€ ì•Šê³  ë‹¤ì‹œ ê°€ì ¸ì˜´

- ìœˆë„ìš° í¬ì»¤ìŠ¤ ì‹œ ìë™ ìƒˆë¡œê³ ì¹¨ : ì‚¬ìš©ìê°€ ë¸Œë¼ìš°ì € íƒ­ì„ ë‹¤ì‹œ í™œì„±í™”í•˜ë©´ ë°ì´í„°ê°€ ìƒˆë¡œê³ ì¹¨ë˜ëŠ”ë°, ì´ ê¸°ëŠ¥ì´ í•„ìš” ì—†ëŠ” ê²½ìš° refetchOnWindowFocus : falseë¥¼ ì‚¬ìš©í•˜ë©´ ë˜ëŠ” ë“±ì˜ ì¶”ê°€ ì˜µì…˜

- ê°„ë‹¨í•œ API í˜¸ì¶œ ì½”ë“œ : ë¶ˆí•„ìš”í•œ ìƒíƒœ ë³€ìˆ˜ë¥¼ ì—†ì• ê³ , ê°€ë…ì„±ì´ ì¦ì§„ë¨.

#### ì‹¤ìŠµ íŒŒíŠ¸ì—ì„œ

- ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ëŠ” ë°ì´í„° ìºì‹±ì„ ì²˜ë¦¬í•˜ëŠ” QueryClientProvider ì™€ QueryClient ì»´í¬ë„ŒíŠ¸ë¥¼ ì œê³µ
QueryClient ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±(function App ì™¸ë¶€ì—ì„œ)í•˜ê³ , App ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ QueryClientProvider ë¥¼ ë Œë”ë§

- ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ ì‚¬ìš©ì„ ìœ„í•´ì„œëŠ” importê°€ í•„ìš”í•¨(axios ë•Œì²˜ëŸ¼)

```jsx
import { QueryClient, QueryClientProvider } from '@tanstack/react-query'
import './App.css'

const queryClient = new QueryClient();

function App() {

  return (
    <>
      <QueryClientProvider client={queryClient}>
        
      </QueryClientProvider>
    </>
  )
}

export default App;
```

ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ì—ì„œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ í˜¸ì¶œí•˜ëŠ”ë° ì´ìš©ë˜ëŠ” useQuery í›… í•¨ìˆ˜ê°€ ìˆìŠµë‹ˆë‹¤.

í˜•ì‹ :

```jsx
const query = useQuery({queryKey: ['repositories'], queryFn:getRepositories})
```

* ìœ ì˜ì‚¬í•­
- queryKeyëŠ” ì¿¼ë¦¬ë¥¼ ìœ„í•œ ê³ ìœ í•œ í‚¤ë¡œ ë°ì´í„°ì˜ ìºì‹±ê³¼ ë‹¤ì‹œ ê°€ì ¸ì˜¤ê¸°ì— ì´ìš©
- queryFnì€ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜ì´ë©° 'í”„ë¡œë¯¸ìŠ¤ë¥¼ ë°˜í™˜'í•´ì•¼ í•œë‹¤.

useQuery í›…ì´ ë°˜í™˜í•˜ëŠ” query ê°ì²´ì—ëŠ” ì¿¼ë¦¬ ìƒíƒœì™€ ê°™ì€ ì¤‘ìš” ì†ì„±ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

í˜•ì‹ :

```jsx
const { isLoading, isError, isSuccess } = useQuery({queryKey: ['repositories'], queryFn:getRepositories});
```

ê°ì²´ì˜ êµ¬ì¡° ë¶„í•´ í˜•íƒœë¡œ ì„¤ëª… -> ì´ìƒì˜ ì½”ë“œê°€ í•´ì„ë˜ì–´ì•¼ë§Œ í•©ë‹ˆë‹¤.

- isLoading : ë°ì´í„°ë¥¼ ì•„ì§ ì´ìš©í•  ìˆ˜ ì—†ìŒ
- isError : ì¿¼ë¦¬ê°€ ì˜¤ë¥˜ë¡œ ì¢…ë£Œ
- isSuccess : ì¿¼ë¦¬ê°€ ì„±ê³µì ìœ¼ë¡œ ì¢…ë£Œë˜ì—ˆìœ¼ë©° ì¿¼ë¦¬ ë°ì´í„°ë¥¼ ì´ìš©í•  ìˆ˜ ìˆìŒ

ê·¸ë˜ì„œ ì´ìƒì˜ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ Github ì˜ˆì œë¥¼ ì‘ìš©

ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•œ ì»´í¬ë„ŒíŠ¸ì¸ Repositories.jsx íŒŒì¼ ìƒì„±

```jsx
import { useQuery } from "@tanstack/react-query";
import axios from "axios";

function Repositories() {
  
  const getRepositories = async () => {
    const response = await axios.get(`https://api.github.com/search/repositories?q=react`);
    return response.data.items;
  }

  const { isLoading, isError, data } = useQuery({
    queryKey: ['repositories'],
    queryFn: getRepositories,
  });

  // ì¡°ê±´ë¶€ ë Œë”ë§ ë¶€ë¶„ êµ¬í˜„ : ë°ì´í„°ë¥¼ ì´ìš©í•  ìˆ˜ ìˆì„ ë•Œ ë Œë”ë§
  // REST API í˜¸ì¶œì´ ì˜¤ë¥˜ë¡œ ëë‚˜ëŠ” ê²½ìš° ë©”ì‹œì§€ ë Œë”ë§
  if(isLoading) {
    return <p>ë¡œë”©ì¤‘...âŒ›â³</p>
  }

  if(isError) {
    return <p>ì˜¤ë¥˜ ë°œìƒí–ˆìŠµë‹ˆë‹¤ ğŸ› </p>
  }
  else{
    return (
      <table>
        <tbody>
          {
            data.map(repo =>
              <tr key={repo.id}>
                <td>{repo.full_name}</td>
                <td>
                  <a href={repo.html_url}>{repo.html_url}</a>
                </td>
              </tr>)
          }
        </tbody>
      </table>
    );
  }
}

export default Repositories;
```

ì´ìƒì˜ ì½”ë“œì—ì„œ ì €í¬ê°€ ì£¼ëª©í•´ì•¼ í•  ì ì€

ë” ì´ìƒ App.jsxì— í•œë²ˆì— ì „ë¶€ ë‹¤ì“°ì§€ ì•Šê³ , í•„ìš” ê¸°ëŠ¥ì„ Componentë¡œ ë¶„í•  í–ˆë‹¤ëŠ” ì 

ê·¸ë¦¬ê³  Repositoriesë¼ëŠ” Component ìì²´ë¥¼ App.jsxì— ì§‘ì–´ë„£ì—ˆìŠµë‹ˆë‹¤.

component1,2,3,4,5 ì´ë ‡ê²Œ ìƒì„±í•´ì„œ App.jsxì— ë„£ê¸°ë§Œ í•˜ë©´ -> ì €í¬ëŠ” ì—¬íƒœê¹Œì§€ App.jsxë¥¼ ë§Œë“¤ì—ˆë‹¤ ë³´ë‹ˆê¹Œ main.jsxì— í•˜ë‚˜í•˜ë‚˜ ë‹¤ ì§‘ì–´ ë„£ì–´ì™”ìŠµë‹ˆë‹¤.

ì´ì œ ì €í¬ëŠ” ì „ì²´ App.jsx ë‚´ì— êµ¬ì—­êµ¬ì—­ì„ Component ë“¤ë¡œ ì±„ì›Œë„£ëŠ” ë°©ì‹ì„ ì—°ìŠµí•´ ë‚˜ê°ˆ ì˜ˆì •(ê·¸ ê³¼ì •ì—ì„œ ë‹¤ì–‘í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´ìš©ì„ í•  ì˜ˆì •)

- ê·¸ë¦¬ê³  ì´ìƒì˜ ì•±ì€ ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ìš©í•´ì„œ ë¦¬í¬ì§€í† ë¦¬ ì •ë³´ë“¤ì„ ê°€ì§€ê³  ì˜¤ê³ , ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ ë‚´ì¥ ê¸°ëŠ¥ì„ ì´ìš©í•˜ì—¬ ìš”ì²­ ìƒíƒœë¥¼ ì‰½ê²Œ(useStateë¥¼ ì“¸ë•Œë³´ë‹¤) ì²˜ë¦¬í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ê°€ ë°ì´í„° ê´€ë¦¬ì™€ ìºì‹±ì„ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ì‘ë‹µ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•œ ìƒíƒœ(data, setData) ê°€ í•„ìš”í•˜ì§€ ì•ŠìŒ

ìš°ë¦¬ì˜ ë³µìŠµ í¬ì¸íŠ¸ëŠ” githubapiapp ê³¼ gitapiì˜ ì½”ë“œ ìƒì˜ ì°¨ì´ì ì´ ë˜ê² ìŠµë‹ˆë‹¤.

- ê°œë°œì ë„êµ¬ì˜ Network íƒ­ì—ì„œ ìƒˆì°½ê³¼ ë¦¬ì•¡íŠ¸ í”„ë¡œì íŠ¸ ì°½ì„ ì™”ë‹¤ê°”ë‹¤ í•´ë³´ë©´ ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ì— ì˜í•´ ìë™ìœ¼ë¡œ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê¸°ê°€ ì‹¤í–‰ëœë‹¤ëŠ” ì ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¦‰, ë¸Œë¼ìš°ì €ì— í¬ì»¤ìŠ¤ë¥¼ ë§ì¶œ ë•Œë§ˆë‹¤(ë¦¬ì•¡íŠ¸ ì•±ìœ¼ë¡œ ì°½ì´ ë„˜ì–´ê°ˆ ë•Œë§ˆë‹¤) ì—…ë°ì´íŠ¸ëœ ë°ì´í„°ë¥¼ ë³¼ ìˆ˜ ìˆëŠ” ì¢‹ì€ ê¸°ëŠ¥ì…ë‹ˆë‹¤. ì´ ê¸°ë³¸ ì‘ë™ì„ ì „ì—­ì ìœ¼ë¡œ í˜¹ì€ ì¿¼ë¦¬ë³„ë¡œ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

* ì°¸ê³ ì‚¬í•­ : ë„¤íŠ¸ì›Œí¬ê°€ ë‹¤ì‹œ ì—°ê²°ë˜ê±°ë‚˜ ì¿¼ë¦¬ì˜ ìƒˆ ì¸ìŠ¤í„°ìŠ¤ê°€ ë§ˆìš´íŠ¸ ë  ë•Œ (ì»´í¬ë„ŒíŠ¸ê°€ DOMì— ì‚½ì…ë  ë•Œ) ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê¸°ë„ ìë™ìœ¼ë¡œ ì‹¤í–‰ë¨

#### ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ì˜ ì¶”ê°€ í•µì‹¬ ì†ì„±ë“¤
- staleTime : ë°ì´í„°ê°€ ìµœì‹ ìœ¼ë¡œ ìœ ì§€ë˜ëŠ” ì‹œê°„ì„ ê·œì • -> í•´ë‹¹ ì‹œê°„ì„ ë„˜ê¸°ë©´ ì˜¤ë˜ëœ ê²ƒìœ¼ë¡œ ê°„ì£¼ë˜ì–´ ë°±ê·¸ë¼ìš´ë“œë¡œ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê²Œ ë¨. default ê°’ì€ 0ì´ë©° ì´ëŠ” ì¿¼ë¦¬ ì„±ê³µ ì§í›„ ë°ì´í„°ê°€ ìµœì‹ ì´ ì•„ë‹Œ ìƒíƒœê°€ ëœë‹¤ëŠ” ì˜ë¯¸. ê·¸ë˜ì„œ ë°ì´í„°ê°€ ìì£¼ ë³€ê²½ë˜ì§€ ì•ŠëŠ” ê²½ìš° staleTime ê°’ì„ ì„¤ì •í•˜ë©´ ë¶ˆí•„ìš”í•œ ë‹¤ì‹œ ê°€ì ¸ì˜¤ê¸°ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆìŒ.

ì ìš© ì‚¬ë¡€
```jsx
const { isLoading, isError, data } = useQuery({
  queryKey: ['repositories'],
  queryFn: getRepositories,
  staleTime: 60 * 1000, // ë°€ë¦¬ì´ˆ ë‹¨ìœ„ì´ê¸° ë•Œë¬¸ì— 1ë¶„ì„ ì˜ë¯¸í•¨.
});
```

- cacheTime : ë¹„í™œì„± ìƒíƒœì¸ ì¿¼ë¦¬ë“¤ì´ gabarge collection ëŒ€ìƒì´ ë˜ëŠ” íƒ€ì´ë°ì„ ëª…ì‹œí•¨. defaultë¡œëŠ” 5ë¶„ 

#### useMutation Hook

: ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ ìƒì—ì„œ ë‚´ì¥ëœ ì˜¤ë¥˜ ì²˜ë¦¬, ìºì‹œ ë¬´íš¨í™”ì™€ í•¨ê»˜ ë°ì´í„° ìƒì„±, ì—…ë°ì´íŠ¸, ì‚­ì œë¥¼ ìœ„í•œ Hook -> ë°ì´í„° ë³€ê²½(Mutation) ì²˜ë¦¬ë¥¼ ê°„ì†Œí™” í•  ìˆ˜ ìˆë„ë¡ í•¨.

ì˜ˆë¥¼ ë“¤ì–´ ìƒˆ ìë™ì°¨ë¥¼ ì¶”ê°€í•˜ê³  ì‹¶ê¸° ë•Œë¬¸ì— POSTì— í•´ë‹¹í•˜ëŠ” HTTP methodë¥¼ ì´ìš©í•œë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„± ê°€ëŠ¥

```jsx
// ì“¸ê±°ë¼ì„œ import -> ìŠìœ¼ë©´ ì•ˆë¨
import {useMutation} from '@tanstack/recat-query';
import axios from 'axios';

// ì‚¬ìš©ë²•
const mutation = useMutation({
  mutationFn: (newCar) => {
    return axios.post(`api/cars`, newCar);
  },
  onError: (error, variables, context) => {
    // ë³€ê²½ ì˜¤ë¥˜ì™€ ê´€ë ¨ëœ ë¶€ë¶„ ì²˜ë¦¬
    // ì˜ˆë¥¼ ë“¤ì–´ console.log(error);
  },
  onSuccess: (data, variables, context) => {
    // ë³€ê²½ ì„±ê³µê³¼ ê´€ë ¨ëœ ë¶€ë¶„ ì²˜ë¦¬
  },
});
```
ì´ìƒì˜ ì˜ˆì œì—ì„œì˜ ì½”ë“œ ì„¤ëª…
- mutationFn : í•´ë‹¹ keyì˜ ì†ì„±ê°’ì€ ì„œë²„ì— POST ìš”ì²­ì„ ìˆ˜í–‰í•˜ê³ , 'í”„ë¡œë¯¸ìŠ¤ë¥¼ ë°˜í™˜'
- onSuccess / onError : ì„±ê³µì‹œ / ì‹¤íŒ¨ì‹œ ì ìš© í•¨ìˆ˜

```jsx
// ì´ìƒì˜ ì½”ë“œì™€ í•©ì³ì„œ ê°ì²´ëª….ì½”ë“œëª…(argument); í˜•íƒœë¡œ ì‹¤í–‰í–ˆë‹¤ëŠ” ì˜ë¯¸
mutation.mutate(newCar);
```
ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ë³€ê²½ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŒ.

#### QueryClientì˜ ë©”ì„œë“œ

- invalidateQueries() : ìºì‹œ ë‚´ ì¿¼ë¦¬ë¥¼ ë¬´íš¨í™”í•˜ëŠ”ë° ì‚¬ìš©. ë§Œì•½ ìºì‹œì—ì„œ ì¿¼ë¦¬ê°€ ë¬´íš¨í™”ë˜ë©´ í•´ë‹¹ ì¿¼ë¦¬ëŠ” ë‹¤ì‹œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ê²ƒì…ë‹ˆë‹¤.

ì´ì „ ì˜ˆì‹œì—ì„œëŠ” useMu ì„ í†µí•´ì„œ ì„œë²„ì— ìƒˆë¡œìš´ ìë™ì°¨ë¥¼ ì¶”ê°€(POST ì‘ì—…) í–ˆìŒ. ë§Œì•½ ëª¨ë“  ìë™ì°¨ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¿¼ë¦¬ê°€ ìˆê³ , ê·¸ ì¿¼ë¦¬ì˜ IDê°€ carsë¼ë©´ ìƒˆ ìë™ì°¨ê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ëœ í›„ì— í•´ë‹¹ ì¿¼ë¦¬ë¥¼ ë¬´íš¨í™”í•´ì•¼í•  ê²ƒ ì…ë‹ˆë‹¤.

ì˜ˆì‹œ
```jsx
import {useQuery, useMutation, useQueryClient } from '@tanstack/react-query';

const queryClient = useQueryClient();

// ëª¨ë“  ìë™ì°¨ë¥¼ ê°€ì ¸ì˜¨ë‹¤ë©´
const {data} = useQuery({
  queryKey: ['cars'],
  queryFn: fetchCars,
})

// ìƒˆ ìë™ì°¨ ì¶”ê°€ ê³¼ì •
const mutation = useMutation({
  mutationFn: (newCar) => {
    return axios.post(`api/cars`,newCar);
  },
  onError: (error, vaiables, context) => {
    // ë³€ê²½ ì˜¤ë¥˜ ê´€ë ¨ ë¡œì§
  }
  onSuccess: (data, vaiables, context) => { // axios.post()ì—ì„œ ì¶”ê°€ëœ ë¶€ë¶„
    // cars ì¿¼ë¦¬ ë¬´íš¨í™”
    queryClient.invalidateQueries({queryKey:['cars']});
  },
})
```

* 'ìºì‹œë¥¼ ë¬´íš¨í™”' í•œë‹¤ëŠ” ê²ƒì˜ ì˜ë¯¸ : ìºì‹œ ì´í›„ì— ì„œë²„ì— ì¶”ê°€ëœ ìƒˆ ìë™ì°¨ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¨ë‹¤ëŠ” ì˜ë¯¸ê°€ ë©ë‹ˆë‹¤.

# 20250306 ~ 20250307 ì—ì„œì˜ ìˆ˜ì—… ìš”ì•½

: Reactë¥¼ ì´ìš©í•œ ë„¤íŠ¸ì›Œí‚¹.
1. ë¹„ë™ê¸° ë„¤íŠ¸ì›Œí¬ í˜¸ì¶œì„ ë” ì‰½ê²Œ êµ¬í˜„í•˜ëŠ” í”„ë¡œë¯¸ìŠ¤(ì½œë°± í•¨ìˆ˜ì˜ ë°œì „í˜•)
2. Axios / React query ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
3. fetch API - openweather api / axios API - github REST API
4. ê²½ìŸ ì¡°ê±´ê³¼ ê´€ë ¨ëœ ë‚´ì¬ëœ ë¬¸ì œì ì„ í™•ì¸ -> React Queryë¥¼ í™œìš©í•˜ì—¬ í•´ê²°
5. React Query í™œìš© ë°ì´í„°ë¥¼ ê°€ì§€ê³  ì˜¤ëŠ” ë°©ë²•(axiosë„ í•¨ê»˜ ì‚¬ìš©)

# ì„œë“œíŒŒí‹° ì»´í¬ë„ŒíŠ¸

- awesome-react-components ê²€ìƒ‰
  - https://github.com/brillout/awesome-react-components ë¡œ ì´ë™
- ctrl + f ëˆŒëŸ¬ì„œ í‚¤ì›Œë“œ ì…ë ¥ í›„ì— ê²€ìƒ‰í•˜ë©´ ëŒ€ì¶© ë‚˜ì˜´
- ì´ë²ˆ ì‹œê°„ì—ëŠ” í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ì—ì„œ í•„ìš”í•œ ê²ƒë“¤ì„ ë¹¼ì™€ì„œ ì–´ë–»ê²Œ ì ìš©í• ì§€ì— ëŒ€í•´ ìˆ˜ì—…í•  ì˜ˆì •
  - ì €í¬ëŠ” react-date-picker ì‚¬ìš©

ì„œë“œíŒŒí‹° ì»´í¬ë„ŒíŠ¸ ì„¤ì¹˜ ëª…ë ¹ì–´
```cmd
npm install ì»´í¬ë„ŒíŠ¸_ì´ë¦„

ê·¸ë˜ì„œ ì €í¬ëŠ”
npm install react-date-picker
```

npm install react-date-pickerë¡œ ì„¤ì¹˜í•˜ë©´ ê°€ì¥ ìµœì‹  ë²„ì „ ì„¤ì¹˜

npm install react-date-picker@4
ì¼ ê²½ìš° ì €í¬ê°€ vite project ë§Œë“¤ ë•Œì²˜ëŸ¼ ë²„ì „ì„ ëª…ì‹œí•˜ëŠ” ê²ƒì´ ê°€ëŠ¥

- ì‚­ì œ ëª…ë ¹ì–´
```cmd
npm uninstall ì»´í¬ë„ŒíŠ¸_ì´ë¦„
```

- í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ ì˜¤ë˜ëœ ì»´í¬ë„ŒíŠ¸ë¥¼ í™•ì¸í•˜ëŠ” ëª…ë ¹ì–´
```cmd
npm outdated
```
ì¶œë ¥ì´ ë¹„ì–´ìˆìœ¼ë©´ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ìµœì‹ ì´ë¼ëŠ” ì˜ë¯¸

- í•œêº¼ë²ˆì— ì—…ë°ì´í‹€ í• ë ¤ë©´
```cmd
npm update
```

## AG Grid

ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ì²˜ëŸ¼ ë°ì´í„°ë¥¼ í‘œì‹œí•˜ëŠ” ë° ì´ìš© ê°€ëŠ¥í•˜ë©´ì„œ, ìƒí˜¸ ì‘ìš©ì´ ë˜ëŠ” ê·¸ë¦¬ë“œ ì»´í¬ë„ŒíŠ¸, í•„í„°ë§ / ì •ë ¬ / í”¼ë²— ë“± ìœ ìš©í•œ ê¸°ëŠ¥ì´ ìˆìŒ. ìœ /ë¬´ë£Œë²„ì „ì´ ìˆëŠ”ë° ì €í¬ëŠ” ë¬´ë£Œì‚¬ìš©

### githubapiapp í´ë”ë¡œ ë„˜ì–´ê°

App2.tsx íŒŒì¼ ë§Œë“¤ê³ , í‘œ ë¶€ë¶„ì„ ì „ë¶€ ë‚ ë¦¼
ì™œ -> App.tsxë‚´ë¶€ì—ì„œëŠ” ì €í¬ê°€ ì •ì˜í–ˆê³ , ë¦¬ì•¡íŠ¸ ìì²´ì—ì„œ ì§€ì›í•˜ëŠ” App.css í˜•íƒœë¡œì˜ í…Œì´ë¸”ì„ ìƒì„±í–ˆì§€ë§Œ, ì´ì œëŠ” AG Gridë¥¼ ì´ìš©í•  ì˜ˆì •

ê·¸ë ‡ë‹¤ë©´ ì„œë“œíŒŒí‹°ë¥¼ ì‚¬ìš©í•  ê±°ê¸° ë•Œë¬¸ì— ì–´ë–¤ ê³¼ì •ì´ í•„ìš”í•˜ë‹¤? -> npm install
- npm install ag-grid-community ag-grid-react
- ë‹¤ì–‘í•œ ag grid ê´€ë ¨ css ì¤‘ì— material ë””ìì¸ ìŠ¤íƒ€ì¼ ì •ìš©ì„ í•˜ê¸° ìœ„í•´
```tsx
import { AgGridReact } from 'ag-grid-react';
import 'ag-grid-community/styles/ag-grid.css';
import 'ag-grid-community/styles/ag-theme-material.css';
```
ë¥¼ import í–ˆìŠµë‹ˆë‹¤. css íŒŒì¼ë“¤ì˜ ê²½ìš°ì—ëŠ” node modules í´ë” (ì˜ì¡´ì„±ì„ ëª¨ì•„ë‘”)ì— ag-grid-community í™•ì¸

```tsx
import { AgGridReact } from 'ag-grid-react';
import 'ag-grid-community/styles/ag-grid.css';
import 'ag-grid-community/styles/ag-theme-material.css';
import { useState } from 'react';
import axios from 'axios';
import './App.css'

type Repository = {
  id: number;
  full_name: string;
  html_url: string;
};

function App() {
  const [keyword, setKeyword] = useState('');
  const [repodata, setRepodata] = useState<Repository[]>([]);

  const handleClick = () => {
    // REST APIí˜¸ì¶œ ë¡œì§ êµ¬í˜„
    axios.get<{items: Repository[]}>(`https://api.github.com/search/repositories?q=${keyword}`)
    .then(response => setRepodata(response.data.items))
    .catch(err => console.log(err))
  }

  return (
    <>
      <input 
        value={keyword}
        onChange={e => setKeyword(e.target.value)}
      />
      <br /><br />
      <button onClick={handleClick}>Search</button>
      <div 
        className="ag-theme-material"
        style={{height: 500, width: 850}}>
      <AgGridReact rowData={repodata} />
      </div>
    </>
  );
}

export default App
```

AgGridReact ì»´í¬ë„ŒíŠ¸ë¥¼ ì ìš©í•˜ì—¬ ê±°ê¸°ì— repodataë¥¼ ì§‘ì–´ ë„£ìŒ
-> ag-gridì— ì´ìš©ëœ ì»¬ëŸ¼ë“¤ì„ ì •ì˜

ì»¬ëŸ¼ ì •ì˜ ê°ì²´ì˜ ë°°ì—´ì¸ columDefsë¼ëŠ” ìƒíƒœë¥¼ ì •ì˜. ag-gridëŠ” ì—¬ê¸°ì— ì´ìš©í•  ìˆ˜ ìˆëŠ” ColDef íƒ€ì…ì„ ì œê³µ. ì»¬ëŸ¼ ê°ì²´ì—ì„œëŠ” í•„ìˆ˜ field í”„ë¡­ì„ ì´ìš©í•˜ì—¬ ë°ì´í„° ì ‘ê·¼ìë¥¼ ì •ì˜ í•´ì•¼í•¨. field ê°’ì€ ì»¬ëŸ¼ì´ í‘œì‹œí•´ì•¼ í•˜ëŠ” REST API ì‘ë‹µ ë°ì´í„°ìœ¼ ã…£ì†ì„± ì´ë¦„ì— í•´ë‹¹

```tsx
import {ColDef} from 'ag-grid-community';

// ì»¬ëŸ¼ ì •ì˜
const [columnDefs] = useState<ColDef[]>([
  {field: 'id'},
  {field: 'full_name'},
  {field: 'html_url'},
]);
```

- ì´ìƒìœ¼ë¡œ ì‘ì„±í•˜ë‹ˆê¹Œ í˜„ì¬ ì˜¤ë¥˜ ë°œìƒí•´ì„œ ì›”ìš”ì¼ì— ìˆ˜ì •

